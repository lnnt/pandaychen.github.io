---
layout: post
title: 数据结构与算法回顾（八）：海量整数排序的分治式解决思路（未完待续）
subtitle: 一道 pingcap 的算法题目
date: 2022-05-28
header-img: img/super-mario.jpg
author: pandaychen
catalog: true
tags:
    - 数据结构
    - Sort
---

##  0x00    前言
问题：实现一个 `16M` 大小的整数 `int64` 的数组排序，如何实现？采用多路归并方式实现

##  0x01    多路归并排序
先简单回顾下，多路归并排序（Multi-way merge sort）是归并排序的一种扩展，它可以同时合并多个有序数组。归并排序的基本思想是将两个有序数组合并成一个有序数组，而多路归并排序是将 k 个有序数组合并成一个有序数组。多路归并排序在处理大规模数据时，可以显著减少磁盘 I/O 次数，提高排序效率。多路归并排序的基本步骤如下：

1.  将待排序的数据分为 `k` 个有序数组
2.  将 `k` 个有序数组两两合并，得到 `k/2` 个有序数组。重复这个过程，直到剩下一个有序数组
3.  输出合并后的有序数组

多路归并排序的时间复杂度为 `O(nlogk)`，其中 `n` 是待排序数据的总数，`k` 是归并的路数。当 `k=2` 时，多路归并排序就是普通的归并排序。多路归并排序的实现可以使用优先队列（如 MinHeap）来选择每次合并的最小元素，从而提高合并的效率。具体步骤如下：

1.  建立一个大小为 `k` 的最小堆，将 `k` 个有序数组的首元素插入到堆中
2.  每次从堆中取出最小元素，将其添加到合并后的数组中
3.  将被取出元素所在数组的下一个元素插入堆中。如果该数组已经没有元素，就跳过这一步
4.  重复步骤 `2` 和 `3`，直到堆为空

####    解决思路
将待排序数组分成多个组，利用多个 goroutine 实现各个组的并行排序；然后通过 Heap(最小堆) 进行多路归并排序；


##  0x03  参考
-   [PingCAP training courses](https://github.com/heteddy/talent-plan/tree/master/tidb/mergesort)
-   [TiDB 源码阅读（十五） Sort Merge Join](https://zhuanlan.zhihu.com/p/41535500)